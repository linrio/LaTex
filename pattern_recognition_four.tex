\documentclass[11pt]{article}
\usepackage{CJK}
\usepackage[top=2cm, bottom=2cm, left=2cm, right=2cm]{geometry}
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{algpseudocode}
\usepackage{amsmath}
\usepackage{enumerate}
\usepackage{tikz}

%\floatname{algorithm}{算法}
%\renewcommand{\algorithmicrequire}{\textbf{输入:}}
%\renewcommand{\algorithmicensure}{\textbf{输出:}} $\clubsuit$
\begin{CJK*}{GBK}{song}
    \title{模式识别与机器学习第四章作业}
    \author{$\spadesuit$ 201628017729xxx   Rio lin $\spadesuit$}
    \date{ 2016 年 12 月 10 日}
\end{CJK*}
\begin{document}
\begin{CJK*}{GBK}{song}
    \maketitle
    \section{求$S_w$和$S_b$}
    \noindent
    设有如下三类模式样本集$\omega_1$, $\omega_2$, $\omega_3$, 其先验概率相等, 求$S_w$和$S_b$: \\
    \[\omega_1: \{(1,0)^T, (2,0)^T, (1,1)^T \}\]
    \[\omega_2: \{(-1,0)^T, (0,1)^T, (-1,1)^T \}\]
    \[\omega_3: \{(-1,-1)^T, (0,-1)^T, (0,-2)^T \}\]

    \paragraph{}\textbf{$S_w$:}
    \[S_w = \sum^{C}_{i=1}P(w_i)E\{(x-m_i)(x-m_i)^T/w_i \} = \sum^{C}_{i=1}P(w_i)C_i\]

     \paragraph{}\textbf{solution:}\\
     \[m_1 = \frac{1}{3}(4,1) \Longrightarrow (\omega_{11} - m_1) = \frac{1}{3}(-1,-1), (\omega_{12} - m_1) = \frac{1}{3}(2,-1), (\omega_{13} - m_1) = \frac{1}{3}(-1,2)\]
     \[m_2 = \frac{1}{3}(-2,2) \Longrightarrow (\omega_{21} - m_2) = \frac{1}{3}(-1,-2), (\omega_{22} - m_2) = \frac{1}{3}(2,1), (\omega_{23} - m_2) = \frac{1}{3}(-1,1)\]
     \[m_3 = \frac{1}{3}(-1,-4) \Longrightarrow (\omega_{31} - m_3) = \frac{1}{3}(-2,1), (\omega_{32} - m_3) = \frac{1}{3}(1,1), (\omega_{33} - m_3) = \frac{1}{3}(1,-2)\]

     $\omega_1: E\{(\omega_1 - m_1)(\omega_1 - m_1)^T \}$
     \[= \frac{1}{3} \{\frac{1}{3}(-1,-1)^T\frac{1}{3}(-1,-1) + \frac{1}{3}(2,-1)^T\frac{1}{3}(2,-1) + \frac{1}{3}(-1,2)^T\frac{1}{3}(-1,2) \} \]
     \[= \frac{1}{9}\begin{bmatrix} 2 & -1 \\ -1 & 2 \end{bmatrix}  \]

     $\omega_2: E\{(\omega_2 - m_2)(\omega_2 - m_2)^T \}$
     \[= \frac{1}{3} \{\frac{1}{3}(-1,-2)^T\frac{1}{3}(-1,-2) + \frac{1}{3}(2,1)^T\frac{1}{3}(2,1) + \frac{1}{3}(-1,1)^T\frac{1}{3}(-1,1) \} \]
     \[= \frac{1}{9}\begin{bmatrix} 2 & 1 \\ 1 & 2 \end{bmatrix}  \]

     $\omega_3: E\{(\omega_3 - m_3)(\omega_3 - m_3)^T \}$
     \[= \frac{1}{3} \{\frac{1}{3}(-2,1)^T\frac{1}{3}(-2,1) + \frac{1}{3}(1,1)^T\frac{1}{3}(1,1) + \frac{1}{3}(1,-2)^T\frac{1}{3}(1,-2) \} \]
     \[= \frac{1}{9}\begin{bmatrix} 2 & -1 \\ -1 & 2 \end{bmatrix}  \]

     \[S_w = \frac{1}{3} \times \frac{1}{9}\begin{bmatrix} 2 & -1 \\ -1 & 2 \end{bmatrix} + \frac{1}{3} \times \frac{1}{9}\begin{bmatrix} 2 & 1 \\ 1 & 2 \end{bmatrix} + \frac{1}{3} \times \frac{1}{9}\begin{bmatrix} 2 & -1 \\ -1 & 2 \end{bmatrix} = \frac{1}{27}\begin{bmatrix} 6 & -1 \\ -1 & 6 \end{bmatrix} \]

     \paragraph{}\textbf{$m_0$:}
     \[m_0 = E(x) = \sum^{C}_{i=1}P(\omega_i)m_i = \frac{1}{3}m_1 + \frac{1}{3}m_2 + \frac{1}{3} m_3 = \frac{1}{3}(\frac{1}{3},-\frac{1}{3})\]
     \[w_1: m_1 - m_0 = \frac{1}{3}(\frac{11}{3},\frac{4}{3})\]
     \[w_2: m_2 - m_0 = \frac{1}{3}(-\frac{7}{3},\frac{7}{3})\]
     \[w_3: m_3 - m_0 = \frac{1}{3}(-\frac{4}{3},-\frac{11}{3})\]

     \paragraph{}\textbf{$S_b$:}
     \[S_b = \frac{1}{3}\{ \frac{1}{3}(\frac{11}{3},\frac{4}{3})^T\frac{1}{3}(\frac{11}{3},\frac{4}{3}) + \frac{1}{3}(-\frac{7}{3},\frac{7}{3})^T\frac{1}{3}(-\frac{7}{3},\frac{7}{3}) + \frac{1}{3}(-\frac{4}{3},-\frac{11}{3})^T\frac{1}{3}(-\frac{4}{3},-\frac{11}{3})  \}\]
     \[= \frac{1}{27} \begin{bmatrix} \frac{62}{3} & \frac{13}{3} \\ \frac{13}{3} & \frac{62}{3} \end{bmatrix} \]

     \paragraph{}\textbf{$S_t$:}
     \[S_t = S_w + S_b = \frac{1}{27}\begin{bmatrix} 6 & -1 \\ -1 & 6 \end{bmatrix}  + \frac{1}{27} \begin{bmatrix} \frac{62}{3} & \frac{13}{3} \\ \frac{13}{3} & \frac{62}{3} \end{bmatrix} \]

    \section{用K-L变换，分别把特征空间维数降到二维和一维}
    \noindent
    设有如下两类样本集，其出现的概率相等:
    \[\omega_1: \{(0,0,0)^T, (2,0,0)^T, \{(2,0,1)^T, (1,2,0)^T \}\]
    \[\omega_2: \{(0,0,1)^T, (0,1,0)^T, \{(0,-2,1)^T, (1,1,-2)^T \}\]
    用K-L变换，分别把特征空间维数降到二维和一维，并画出样本在该空间中的位置（可用matlab计算）
    \paragraph{}\textbf{solution:}\\
    \[m = \frac{1}{4} \sum^{4}_{j=1}\omega_{1j} + \frac{1}{4} \sum^{4}_{j=1}\omega_{2j} = \frac{1}{4}(6,2,1) \ne 0\]
    因此得到的是“次最佳”的结果。
    \paragraph{}\textbf{step 1: R}\\
    \[R = \sum^{2}_{i=1}P(\omega_i)E(xx^T) = \frac{1}{2} [ \frac{1}{4}\sum^{4}_{j=1}\omega_{1j}\omega_{1j}^T ] + \frac{1}{2} [ \frac{1}{4}\sum^{4}_{j=1}\omega_{2j}\omega_{2j}^T ] =
     \frac{1}{8}\begin{bmatrix} 10 & 3 & 0 \\ 3 & 10 & -4 \\ 0 & -4 & 7 \end{bmatrix} \]

    \paragraph{}\textbf{step 2: $\Phi$}\\
    解特征值方程 $|R-\lambda I| = 0 \Longrightarrow $  \[ \frac{1}{8}\begin{bmatrix} 10-\lambda & 3 & 0 \\ 3 & 10-\lambda & -4 \\ 0 & -4 & 7-\lambda \end{bmatrix} \]
    求R的特征值.由 $(10-\lambda)^2(7-\lambda) - 16(10-\lambda) - 9(7-\lambda) = 0$ 得特征值
    \[\lambda_1 = -0.618, \lambda_2 = 1.618, \lambda_3 = 1 \]
    对应的特征向量为：
    \[[0,-0.53, -0.85]\]
    \[[0,-0.85,  0.53]\]
    \[[1,    0,     0]\]

    \paragraph{}\textbf{step 1: y}\\
    选$\lambda_2$对应的变换向量作为变换矩阵，由$y = \Phi^T x$得变换后的一维模式特征为：
    \[\omega_1: \{0,        0, 0.52, -1.70 \} \]
    \[\omega_2: \{0.52, -.085, 2.22, -1.89 \} \]
    选$\lambda_2,\lambda_3$对应的变换向量作为变换矩阵，由$y = \Phi^T x$得变换后的二维模式特征为：
    \[\omega_1: \{(0,0), (0,2), (0.52,2), (-1.70,1) \} \]
    \[\omega_2: \{(0.52,0), (-0.85,0), (2.22,0), (-1.89,1) \} \]
    样本在该空间中的位置（用python计算），一维模式特征如图 \ref{kl} 。二维模式特征如图 \ref{kl2} 。

    \begin{figure*}[!t]
        \centering
        \includegraphics[width=0.8\textwidth]{kl.jpg}
        \caption{K-L Transform for One-dimensional category}
        \label{kl}
    \end{figure*}

    \begin{figure*}[!t]
        \centering
        \includegraphics[width=0.8\textwidth]{kl2.jpg}
        \caption{K-L Transform for Two-dimensional category}
        \label{kl2}
    \end{figure*}

\end{CJK*}
\end{document} 